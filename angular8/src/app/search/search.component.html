<div id="content">
  <hr>
  <h6 class="text text-center text-dark"><strong>Search Results</strong></h6>
  <hr>
  <div class="container" >
    <div class="row">
        <div class="spinner-border text-success" *ngIf="loading" style="margin-bottom: 0;margin-left: 45%;  margin-top: 5%"></div>
    </div>
    <div class="row" >
      <div class="col-lg-3 col-md-4 col-sm-12 col-xs-12" [ngStyle]="{'display': displayFilters}">
        <h6 class="text text-center"><strong>Filter Results</strong></h6>
        <div class="col-xs-12">
            <button class="btn btn-block btn-outline-warning btn-sm" (tap)="toggleIcon('price')" data-toggle="collapse" href="#collapsePrice" role="button" aria-expanded="false" aria-controls="collapseExample">
              <span class="float-left"><strong>Price</strong></span>
              <mat-icon class="float-right" *ngIf="priceIcon">expand_more</mat-icon>
              <mat-icon class="float-right" *ngIf="!priceIcon">expand_less</mat-icon>
            </button>
            <div class="collapse" id="collapsePrice">
              <div class="card card-body">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios" (change)="checkCheckBoxvalue({maxPrice:100000})">
                  <label class="form-check-label" for="exampleRadios1">
                    less than 100,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:250000})">
                  <label class="form-check-label" for="exampleRadios2">
                    less than 250,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:500000})">
                  <label class="form-check-label" for="exampleRadios1">
                    less than 500,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:1000000})">
                  <label class="form-check-label" for="exampleRadios2">
                    less than 1,000,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:2500000})">
                  <label class="form-check-label" for="exampleRadios1">
                    less than 2,500,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:5000000})">
                  <label class="form-check-label" for="exampleRadios2">
                    less than 5,000,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:00100000})">
                  <label class="form-check-label" for="exampleRadios1">
                    less than 10,000,000
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="priceRadios"  (change)="checkCheckBoxvalue({maxPrice:10000000000000})">
                  <label class="form-check-label" for="exampleRadios2">
                    Over 10,000,000
                  </label>
                </div>
              </div>
            </div>
        </div>
        <br>
        <div class="col-xs-12">
          <button class="btn btn-block btn-outline-danger btn-sm" (tap)="toggleIcon('sellerType')" data-toggle="collapse" href="#collapseSellerType" role="button" aria-expanded="false" aria-controls="collapseExample">
            <span class="float-left"><strong>Seller Category</strong></span>
            <mat-icon class="float-right" *ngIf="sellerTypeIcon">expand_more</mat-icon>
            <mat-icon class="float-right" *ngIf="!sellerTypeIcon">expand_less</mat-icon>
          </button>
          <div class="collapse" id="collapseSellerType">
            <div class="card card-body">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sellerType" (change)="checkCheckBoxvalue({sellerType:'individual'})">
                <label class="form-check-label" for="exampleRadios1">
                  Individuals
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sellerType" (change)="checkCheckBoxvalue({sellerType:'company'})">
                <label class="form-check-label" for="exampleRadios2">
                  Companies
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sellerType"  (change)="checkCheckBoxvalue({sellerType:'both'})">
                <label class="form-check-label" for="exampleRadios1">
                  Both
                </label>
              </div>
            </div>
          </div>
        </div>
        <br>
        <div class="col-xs-12">
          <button class="btn btn-block btn-outline-secondary btn-sm" (tap)="toggleIcon('landUse')" data-toggle="collapse" href="#collapseLandUse" role="button" aria-expanded="false" aria-controls="collapseExample">
            <span class="float-left"><strong>Land Use</strong></span>
            <mat-icon class="float-right" *ngIf="landUseIcon">expand_more</mat-icon>
            <mat-icon class="float-right" *ngIf="!landUseIcon">expand_less</mat-icon>
          </button>
          <div class="collapse" id="collapseLandUse">
            <div class="card card-body">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="landUse"  (change)="checkCheckBoxvalue({landUse:'all'})">
                <label class="form-check-label" for="exampleRadios1">
                  All
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="landUse"  (change)="checkCheckBoxvalue({landUse:'agricultural'})">
                <label class="form-check-label" for="exampleRadios1">
                  Agricultural
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="landUse"  (change)="checkCheckBoxvalue({landUse:'industrial'})">
                <label class="form-check-label" for="exampleRadios2">
                  Industrial
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="landUse"  (change)="checkCheckBoxvalue({landUse:'residential'})">
                <label class="form-check-label" for="exampleRadios1">
                  Residential
                </label>
              </div>
            </div>
          </div>
        </div>
        <br>
        <div class="col-xs-12">
          <button class="btn btn-block btn-outline-success btn-sm" (tap)="toggleIcon('size')" data-toggle="collapse" href="#collapseSize" role="button" aria-expanded="false" aria-controls="collapseExample">
            <span class="float-left"><strong>Size</strong></span>
            <mat-icon class="float-right" *ngIf="sizeIcon">expand_more</mat-icon>
            <mat-icon class="float-right" *ngIf="!sizeIcon">expand_less</mat-icon>
          </button>
          <div class="collapse" id="collapseSize">
            <div class="card card-body">
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:2500})">
                <label class="form-check-label" for="exampleRadios1">
                  less than 2,500 (0.25 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:5000})">
                <label class="form-check-label" for="exampleRadios2">
                  less than 5,000 (0.5 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:10000})">
                <label class="form-check-label" for="exampleRadios1">
                  less than 10,000 (1 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:50000})">
                <label class="form-check-label" for="exampleRadios2">
                  less than 50,000 (5 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:100000})">
                <label class="form-check-label" for="exampleRadios1">
                  less than 100,000 (10 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:500000})">
                <label class="form-check-label" for="exampleRadios2">
                  less than 500,000 (50 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:1000000})">
                <label class="form-check-label" for="exampleRadios1">
                  less than 1,000,000 (100 ha)
                </label>
              </div>
              <div class="form-check">
                <input class="form-check-input" type="radio" name="sizeRadios"  (change)="checkCheckBoxvalue({maxSize:1000000000000000})">
                <label class="form-check-label" for="exampleRadios2">
                  Over 10,000,000 (over 100 ha)
                </label>
              </div>
            </div>
          </div>
        </div> 
        <br> 
        <div class="col-xs-12">
          <button class="btn btn-block btn-outline-primary btn-sm" (tap)="toggleIcon('county')" data-toggle="collapse" href="#collapseCounty" role="button" aria-expanded="false" aria-controls="collapseExample">
            <span class="float-left"><strong>County</strong></span>
            <mat-icon class="float-right" *ngIf="countyIcon">expand_more</mat-icon>
            <mat-icon class="float-right" *ngIf="!countyIcon">expand_less</mat-icon>
          </button>
          <div class="collapse scroll" id="collapseCounty">
              <div class="card card-body">
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="countyRadios"  (change)="checkCheckBoxvalue({county:'all'})">
                    <label class="form-check-label" for="exampleRadios1">
                      All
                    </label>
                  </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="countyRadios"  (change)="checkCheckBoxvalue({county:'kisumu'})">
                  <label class="form-check-label" for="exampleRadios1">
                    Kisumu
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'Kiambu'})">
                  <label class="form-check-label" for="exampleRadios2">
                    Kiambu
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'Nairobi'})">
                  <label class="form-check-label" for="exampleRadios1">
                    Nairobi
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'Kericho'})">
                  <label class="form-check-label" for="exampleRadios2">
                    Kericho
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'Marsabit'})">
                  <label class="form-check-label" for="exampleRadios1">
                    Marsabit
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'meru'})">
                  <label class="form-check-label" for="exampleRadios2">
                    Meru
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'kilifi'})">
                  <label class="form-check-label" for="exampleRadios1">
                    Kilifi
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio"  name="countyRadios"  (change)="checkCheckBoxvalue({county:'turkana'})">
                  <label class="form-check-label" for="exampleRadios2">
                    Turkana
                  </label>
                </div>
              </div>
          </div>
        </div> 
      </div>
      <div class="col-lg-9 col-md-8 col-sm-12 col-xs-12" [ngStyle]="{'display': displayAllProperty}">
        <p *ngIf="found" class="text text-danger text-center">{{message}}</p>
        <div class="row">
          <div class="col-lg-4 col-md-6 col-sm-6 col-xs-12" *ngFor = "let property of propertyData | async | paginate: { id: 'server', itemsPerPage: pageSize, currentPage: p, totalItems: 6 }">
            <div class="card mb-3">
              <div class="row no-gutters">
                <div class="col-md-12">
                  <div id="id{{property.propertyId}}" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                      <div class="carousel-item active">
                        <img  src= "http://46.101.135.64:9000/{{property.propertyLandPhotoOne}}" style="height:200px; width: 100%;">
                      </div>
                      <div class="carousel-item">
                        <img  src= "http://46.101.135.64:9000/{{property.propertyLandPhotoTwo}}" style="height:200px; width: 100%;">
                      </div>
                    </div>
                    <a class="carousel-control-prev" href="#id{{property.propertyId}}" role="button" data-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#id{{property.propertyId}}" role="button" data-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="sr-only">Next</span>
                    </a>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="card-body">
                    <h5 class="card-title text-center"><strong>{{property.propertyCounty}}</strong></h5>
                      <ul style="list-style-type:none; text-align:center;">
                        <li>{{property.propertyAreaName}}</li>
                        <li>ksh {{property.propertystartingPrice}}, {{property.propertySize}} sqM, {{property.propertyDimension}} </li>
                      </ul>
                  </div>
                  <div class="card-footer text-center">
                    <button class="btn btn-sm btn-outline-primary" (tap)="infoModal(property)"><mat-icon>edit</mat-icon>&nbsp;View</button>&nbsp;
                    <button class="btn btn-sm btn-outline-danger" (tap)="phoneModal()"><mat-icon>phone_forwarded</mat-icon>&nbsp;Call</button>&nbsp;
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <pagination-controls (pageChange)="getPage($event)" id="server" *ngIf="!loading && available"></pagination-controls>
        </div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid" *ngIf="singleProperty">
    <span class="text text-primary" id="clickable" (tap)="backToSearch()">back</span>
    <div class="row" >
      <div class="col-lg-8 col-md-8 col-sm-12" style="margin-bottom: 3%;">
          <h6 style="text-align: center; text-decoration: underline;"><strong>Map</strong></h6>
        <agm-map [latitude]="singlePropertyData.propertyLatitude" [longitude]="singlePropertyData.propertyLongitude" [zoom]="15" [mapTypeControl]='true'>
          <agm-marker [latitude]="singlePropertyData.propertyLatitude" [longitude]="singlePropertyData.propertyLongitude"></agm-marker>
        </agm-map>
      </div>
      <div class="col-lg-4 col-md-4 col-sm-12">
        <h6 class="text text-center" style=" text-decoration: underline;"><strong>Details</strong>
          <button class="btn btn-sm btn-success float-right" (tap)="greenCard(singlePropertyData.propertystartingPrice)">View Green Card</button>
        </h6>
        <hr>
        <div id="singleLandCarousel" class="carousel slide" data-ride="carousel">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img  src= "http://46.101.135.64:9000/{{singlePropertyData.propertyLandPhotoOne}}" style="height:200px; width: 100%;">
            </div>
            <div class="carousel-item">
              <img  src= "http://46.101.135.64:9000/{{singlePropertyData.propertyLandPhotoTwo}}" style="height:200px; width: 100%;">
            </div>
          </div>
          <a class="carousel-control-prev" href="#singleLandCarousel" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a class="carousel-control-next" href="#singleLandCarousel" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
        </div>
        <hr>
        <ul>
          <li>Location: {{singlePropertyData.propertyAreaName}}, {{singlePropertyData.propertyCounty}} County</li>
          <li>Sise: {{singlePropertyData.propertySize}} sqM</li>
          <li>Dimension: {{singlePropertyData.propertyDimension}}</li>
          <li>Purpose: {{singlePropertyData.propertyPurpose}}</li>
          <li>Price: ksh {{singlePropertyData.propertystartingPrice}}</li>
          <li>{{singlePropertyData.propertyDescription}}</li>
        </ul>
        <button class="btn btn-sm btn-warning float-right" (tap)="phoneModal(singlePropertyData.propertyId)">Call</button>
      </div>
      <span class="text text-primary" id="clickable" (tap)="backToSearch()">back</span>
    </div>
  </div>
  
  <div *ngIf="showPhoneModal" class="modal" style="overflow-y:auto;" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayPhone}">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content" >
        <div class="modal-body">
          <div class="container">
              <h5 class="text text-center"><strong>Contact Seller</strong></h5>
              <p class="text text-center text-primary">Fill form below to receive seller details via text.</p>
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Enter Your Phone Number">
              </div>  
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-md btn-success float-right">Send</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="onCloseHandled()">Close</button>
        </div>
      </div>
    </div>
  </div>
  
  <div *ngIf="greenCardModal" class="modal" style="overflow-y:auto;" tabindex="-1" role="dialog"  [ngStyle]="{'display':displayGreenCard}">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content" >
        <div class="modal-body">
          <p class="text text-center text-danger" *ngIf="greenCardMessage">{{greenCardMessage}}</p>
          <div class="spinner-border text-success" *ngIf="loadingGreenCard" style="margin-bottom: 0;margin-left: 45%;  margin-top: 5%"></div>
          <div class="container" *ngIf ="!loadingGreenCard && !greenCardMessage">
              <h5 class="text text-center"><strong>Contact Seller</strong></h5>
              <p class="text text-justify text-primary">Enter phone number to pay Ksh {{greenCardAmount}} and email to receive green card. A green card is a record of all previous owners of that land</p>
              <form [formGroup]="paymentForm">
                <div class="form-group">
                  <input type="text" class="form-control" formControlName = "phoneNumber" [ngClass] = "{'is-invalid': submitted && f.phoneNumber.errors}" placeholder="Phone Number 7xxxxxxxx">
                  <div *ngIf="submitted && f.phoneNumber.errors" class="invalid-feedback">
                      <div *ngIf="f.phoneNumber.errors.required">Phone number is required</div>
                      <div *ngIf="f.phoneNumber.errors.pattern">Accepted format is 7xxxxxxxx</div>
                  </div>
                </div>
                <div class="form-group">
                  <input type="email" class="form-control" formControlName = "email" [ngClass] = "{'is-invalid': submitted && f.email.errors}" placeholder="Email Address">
                  <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
                      <div *ngIf="f.email.errors.required">Email is required</div>
                      <div *ngIf="f.email.errors.pattern">Invalid Email Address</div>
                  </div>
                </div>
              </form>
          </div>
        </div>
        <div class="modal-footer">
          <button *ngIf ="!loadingGreenCard && !greenCardMessage" class="btn btn-md btn-success float-right" (tap)="onSubmit()">Send</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="onCloseHandled()">Close</button>
        </div>
      </div>
    </div>
  </div>
</div>